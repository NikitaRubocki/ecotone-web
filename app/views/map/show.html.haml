.center.jumbotron
  %h1 Ecotone 
  %h2 An even better map of the campus
/ source: http://getbootstrap.com/examples/carousel/#

.content(id='map')
  :javascript

    console.log('#{plots_url}');
    '#{@ping = Plot.find(1)}'
    console.log('#{@ping.latitude}');
    console.log('#{@ping.longitude}')

    var mapBoxAttribution = 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>'
    var mapBoxRequest = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=#{ENV["LEAFLET_KEY"]}'

    var map = L.map('map').setView([44.0429688, -121.3329103], 18, {layers: [satelliteLayer, outdoorLayer]});

    var plot_1    = L.marker([44.043577, -121.334438]).bindPopup("<a href='#{plots_path}/#{plot_id=1}/'> Plot: #{plot_id=1} </a> <b> Details: #{}</b>"),
      plot_25     = L.marker(['#{@ping.latitude}', '-#{@ping.longitude}']).bindPopup("<a href='#{plots_path}/#{@ping.plot_id}'> Plot ##{@ping.plot_id} </a> <b> Details: #{@ping.location_description}</b>");

    var plot_markers = L.layerGroup([plot_1, plot_25]).addTo(map);

    var satelliteLayer = L.tileLayer(mapBoxRequest, 
    {
      id: 'mapbox/satellite-streets-v11', 
      tileSize: 512, 
      zoomOffset: -1, 
      attribution: mapBoxAttribution,
    }).addTo(map);

    var outdoorLayer = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=#{ENV["LEAFLET_KEY"]}', {
      id: 'mapbox/outdoors-v11', 
      tileSize: 512, 
      zoomOffset: -1, 
      attribution: mapBoxAttribution,
    }).addTo(map);

    var baseMaps = {
      "Satellite": satelliteLayer,
      "Ground": outdoorLayer
    };

    var overlayMaps = {
      "Plots": plot_markers
    };

    L.control.layers(baseMaps, overlayMaps).addTo(map);